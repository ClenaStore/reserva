<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Reserva - Mercatto</title>

<!-- 🔸 Fonte e ícone -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<link rel="icon" href="https://github.com/ClenaStore/cardapiomercatto/blob/main/icons/logo.png?raw=true">

<style>
:root {
  --bg:#0b0f19;
  --card:#151d2f;
  --text:#fff;
  --accent:#b8860b;
  --muted:#94a3b8;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Inter',sans-serif;text-transform:uppercase;}
body{
  background:var(--bg);
  color:var(--text);
  display:flex;
  align-items:center;
  justify-content:center;
  min-height:100vh;
  padding:1rem;
}
form{
  background:var(--card);
  padding:2rem 1.5rem;
  border-radius:1rem;
  width:100%;
  max-width:420px;
  box-shadow:0 0 15px #0005;
  position:relative;
  overflow:hidden;
}
.logo{
  display:flex;
  justify-content:center;
  margin-bottom:1rem;
}
.logo img{
  width:120px;
  height:auto;
  border-radius:50%;
  box-shadow:0 0 10px #000a;
}
h2{
  text-align:center;
  margin-top:.5rem;
  margin-bottom:1rem;
  color:var(--accent);
}
label{
  display:block;
  margin-top:1rem;
  font-weight:600;
  color:var(--muted);
  font-size:.85rem;
}
input,select{
  width:100%;
  padding:.75rem;
  border:none;
  border-radius:.5rem;
  margin-top:.3rem;
  background:#1e293b;
  color:var(--text);
  font-size:.9rem;
}
input:focus, select:focus{
  outline:2px solid var(--accent);
}
.email-highlight{
  color:#fff;
  font-weight:700;
  font-size:1rem;
  margin-top:1.2rem;
}
.email-field{
  border:2px solid var(--accent);
  background:#0f172a;
}
button{
  margin-top:1.5rem;
  width:100%;
  padding:1rem;
  background:var(--accent);
  border:none;
  border-radius:.5rem;
  color:#fff;
  font-weight:600;
  cursor:pointer;
  transition:.3s;
}
button:hover{opacity:.9;transform:scale(1.02);}
small{
  display:block;
  text-align:center;
  color:var(--muted);
  margin-top:1rem;
  font-size:.8rem;
  line-height:1.3;
}
#overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:white;
  z-index:999;
  font-size:1.1rem;
  backdrop-filter:blur(4px);
  opacity:0;
  pointer-events:none;
  transition:.4s;
}
#overlay.active{
  opacity:1;
  pointer-events:all;
}
.loader{
  border:4px solid #333;
  border-top:4px solid var(--accent);
  border-radius:50%;
  width:60px;
  height:60px;
  animation:spin 1s linear infinite;
  margin-bottom:1rem;
}
@keyframes spin{
  0%{transform:rotate(0deg);}
  100%{transform:rotate(360deg);}
}
#sucesso{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.8);
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  color:#fff;
  font-size:1rem;
  backdrop-filter:blur(4px);
  opacity:0;
  pointer-events:none;
  transition:.4s;
}
#sucesso.active{
  opacity:1;
  pointer-events:all;
}
.check{
  width:80px;
  height:80px;
  border:4px solid #16a34a;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  margin-bottom:1rem;
}
.check::after{
  content:'';
  width:30px;
  height:15px;
  border-left:4px solid #16a34a;
  border-bottom:4px solid #16a34a;
  transform:rotate(-45deg);
}
</style>
</head>
<body>

<form id="formReserva">
  <div class="logo">
    <img src="https://github.com/ClenaStore/cardapiomercatto/blob/main/icons/logo.png?raw=true" alt="Logo Mercatto">
  </div>
  <h2>RESERVA MERCATTO</h2>

  <label>NOME</label>
  <input type="text" name="nome" required>

  <label>DATA</label>
  <input type="date" name="data" required>

  <label>HORÁRIO</label>
  <input type="time" name="horario" required>

  <label>MESA</label>
  <input type="text" name="mesa" placeholder="Ex: 03 ou VARANDA">

  <label>Nº DE PESSOAS</label>
  <input type="text" name="pessoas" id="pessoas" required>

  <label>CONTATO</label>
  <input type="tel" name="contato" id="telefone" placeholder="(00) 00000-0000" required>

  <label class="email-highlight">📧 E-MAIL PARA CONFIRMAÇÃO</label>
  <input type="email" name="email" placeholder="Digite seu e-mail para receber a confirmação" required class="email-field">

  <label>OCASIÃO</label>
  <input type="text" name="ocasiao" placeholder="Ex: aniversário, reunião...">

  <label>DECORAÇÃO</label>
  <input type="text" name="decoracao" placeholder="Ex: simples, temática...">

  <label>COMANDAS INDIVIDUAIS</label>
  <select name="comandas">
    <option value="SIM">SIM</option>
    <option value="NÃO">NÃO</option>
  </select>

  <button type="submit">ENVIAR RESERVA</button>

  <small>Bem-vindo ao formulário de reservas.  
  Cobramos couvert artístico de quarta a sábado e taxa de 10%.  
  Após o envio, aguarde nossa confirmação por e-mail.</small>

  <div id="sucesso">
    <div class="check"></div>
    <p>Reserva enviada com sucesso!<br>Verifique seu e-mail de confirmação.</p>
  </div>
</form>

<div id="overlay">
  <div class="loader"></div>
  <p>Enviando sua reserva...</p>
</div>

<script>
// Máscaras
document.getElementById('telefone').addEventListener('input', e=>{
  let x = e.target.value.replace(/\D/g, '').substring(0, 11);
  let ddd = x.substring(0, 2), p1 = x.substring(2, 7), p2 = x.substring(7, 11);
  if (x.length > 7) e.target.value = `(${ddd}) ${p1}-${p2}`;
  else if (x.length > 2) e.target.value = `(${ddd}) ${p1}`;
  else if (x.length > 0) e.target.value = `(${ddd}`;
});
document.getElementById('pessoas').addEventListener('input', e=>{
  e.target.value = e.target.value.replace(/\D/g,'');
});

// Envio ao Google Apps Script
document.getElementById('formReserva').addEventListener('submit', async e=>{
  e.preventDefault();
  const form = e.target;
  const email = form.email.value.trim();
  if(!email){
    alert("Por favor, insira um e-mail válido para receber a confirmação.");
    return;
  }
  const data = Object.fromEntries(new FormData(form).entries());
  const overlay = document.getElementById('overlay');
  overlay.classList.add('active');
  try{
    const resp = await fetch("https://script.google.com/macros/s/AKfycbzbbjYBrM1MTrNR-o3KlFlqS55erbmWmSuTGqvUfFFT6ksplqT7EYJB5umURWl0x7Pn/exec", {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify(data)
    });
    const json = await resp.json();
    overlay.classList.remove('active');
    if(json.status==="success"){
      document.getElementById('sucesso').classList.add('active');
      setTimeout(()=>{
        document.getElementById('sucesso').classList.remove('active');
        form.reset();
      },4000);
    }else{
      alert("Erro: " + json.message);
    }
  }catch{
    overlay.classList.remove('active');
    alert("Erro de conexão. Verifique o link do script.");
  }
});
</script>

</body>
</html>
